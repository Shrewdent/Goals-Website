<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goals Website</title>
    <link rel="stylesheet" type="text/css" href="style.css">

<script>
let boxCounter = 1;

window.onload = function() {
  addBox_Start(document.querySelector(".menu"));
};

  function allowDrop(ev) {
    ev.preventDefault();
  }

  function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
  }








function drop(ev) {
  var data = ev.dataTransfer.getData("text");
  var box = document.getElementById(data);
  var target = ev.target;
  var canvas = document.querySelector(".canvas");
	addBox();
  // Check if target is not the canvas or one of its children
  if (target.id !== 'canvas') {
    target = target.parentNode;
  }

  box.style.left = ev.clientX - 25 + "px";
  box.style.top = ev.clientY - 25 + "px";


  if (box.getAttribute("data-new") === "true") {
    var input = document.createElement("textarea");
    input.value = "Box";
    input.onblur = function() {
      input.value = input.value || "Box";
    };
    box.appendChild(input);
    box.setAttribute("data-new", "false");
  }

  target.appendChild(box);
  ev.preventDefault();
}



	function addBox() {
	  var menu = document.querySelector(".menu");
	  var box = document.createElement("div");
	  box.classList.add("box");
	  box.id = "Widget_" + boxCounter;
	  box.draggable = true;
	  box.ondragstart = function(ev) {
		drag(ev);
	  };
	  box.setAttribute("data-new", "true");
	  menu.appendChild(box);
	  boxCounter++;
	}
	
	function addBox_Start(parentElement) {
	  var box = document.createElement("div");
	  box.classList.add("box");
	  box.id = "Widget_" + boxCounter;
	  box.draggable = true;
	  box.ondragstart = function(ev) {
		drag(ev);
	  };
	  box.setAttribute("data-new", "true");
	  parentElement.appendChild(box);
	  boxCounter++;
	}


</script>

  </head>
  <body>
    <header>
      <h1>Goals Website</h1>
    </header>

    <main class="container" >
      <div class="canvas" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="menu" name="widget_holder">


      </div>
    </main>

  </body>
</html>